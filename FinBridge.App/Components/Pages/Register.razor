@page "/register"

@using Microsoft.AspNetCore.Components.Forms
@using FinBridge.App.Models
@using FinBridge.App.Services

@inject NavigationManager Navigation
@inject IAuthenticationService authService

<div class="app-background">
    <h3>Създаване на профил</h3>

    <EditForm Model="@registerModel" OnValidSubmit="HandleRegister">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div>
            <label>Въведе първото Ви име:</label>
            <InputText @bind-Value="registerModel.FirstName" class="input-field" placeholder="Например: Иван" />
        </div>

        <div>
            <label>Въведе вашето презиме:</label>
            <InputText @bind-Value="registerModel.MiddleName" class="input-field" placeholder="Например: Горанов" />
        </div>

        <div>
            <label>Въведете вашата фамилия:</label>
            <InputText @bind-Value="registerModel.LastName" class="input-field" placeholder="например: Цветанков" />
        </div>

        <div>
            <label>Въведете вашият имейл:</label>
            <InputText @bind-Value="registerModel.Email" class="input-field" placeholder="example@example.com" />
        </div>

        <div>
            <label>Въведе измислена от вас парола:</label>
            <InputText @bind-Value="registerModel.Password" type="password" class="input-field" />
        </div>

        <div>
            <label>Потвърдете измислената от вас парола:</label>
            <InputText @bind-Value="registerModel.ConfirmPassword" type="password" class="input-field" />
        </div>

        <div class="checkbox-wrapper">
            <InputCheckbox @bind-Value="registerModel.RememberMe" />
            <label>Запомни ме</label>
        </div>

        <button type="submit">Регистрирайте се</button>
    </EditForm>

    <p>
        Вече имате акаунт?
        <a @onclick="@(() => Navigation.NavigateTo("/login"))">Влезте в профила си</a>
    </p>

</div>

@code {
    private RegisterRequest registerModel = new();

    private async Task HandleRegister()
    {
        var result = await authService.RegisterAsync(registerModel);
        if (result)
        {
            Navigation.NavigateTo("/home");
        }
        else
        {
            Console.WriteLine("Authentication failed.");
        }
    }
}
